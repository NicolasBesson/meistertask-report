(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){e.exports=n(29)},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(12),i=n.n(s),c=(n(20),n(2)),r=n(3),l=n(6),u=n(4),d=n(1),h=n(5),m=(n(21),void 0),k={report:{title:"Compte rendu de r\xe9union",edit_icon:!1,task_details:!0,show_hide:!1},agenda:{title:"Ordre du jour",edit_icon:!1,task_details:!1,show_hide:!1},followup:{title:"Suivi d'activit\xe9s",edit_icon:!0,task_details:!0,show_hide:!1},actionreport:{title:"Actions et Retours attendus",edit_icon:!1,task_details:!0,show_hide:!0}},p=o.a.createContext({mode:k.followup,isConfigured:!1,token:0,projectID:0,setTokenAndProject:function(e,t){return m.setState({token:e,projectID:t,isConfigured:!0})}}),f=(n(22),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},n.handleTokenChange=n.handleTokenChange.bind(Object(d.a)(n)),n.handleProjectChange=n.handleProjectChange.bind(Object(d.a)(n)),n.handleSubmitClick=n.handleSubmitClick.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){}},{key:"handleTokenChange",value:function(e){this.setState({token:e.target.value})}},{key:"handleProjectChange",value:function(e){this.setState({projectID:e.target.value})}},{key:"handleSubmitClick",value:function(e){this.context.setTokenAndProject(this.state.token,this.state.projectID)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(p.Consumer,null,function(t){t.token,t.projectID;return o.a.createElement("div",{className:"wrapper fadeInDown"},o.a.createElement("div",{id:"formContent"},o.a.createElement("div",{className:"fadeIn first"},o.a.createElement("img",{src:"./assets/settings.svg",id:"icon",alt:"User Icon",height:"60",width:"60"})),o.a.createElement("form",null,o.a.createElement("input",{type:"text",id:"tokenValue",className:"fadeIn second",name:"securityToken",placeholder:"Jeton de s\xe9curit\xe9",required:!0,onChange:e.handleTokenChange}),o.a.createElement("input",{type:"text",id:"poject",className:"fadeIn third",name:"projectID",placeholder:"Num\xe9ro de projet",required:!0,onChange:e.handleProjectChange}),o.a.createElement("input",{type:"submit",className:"fadeIn fourth",value:"Valider",onClick:e.handleSubmitClick})),o.a.createElement("div",{id:"formFooter"},o.a.createElement("a",{className:"underlineHover",href:"https://github.com/NicolasBesson/meistertask-report/blob/master/doc/configuration.md"},"Param\xe8tres oubli\xe9s?"))))}))}}]),t}(o.a.Component));f.contextType=p;var v=f,g=(n(23),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).task=e.task,n.token=e.token,n.host=e.host,n.state={isVisible:!0},n.onClickHide=n.onClickHide.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"renderContactEmpty",value:function(e){return o.a.createElement("div",{className:"badge badge-pill badge-warning"},e)}},{key:"renderContactFull",value:function(e,t){return o.a.createElement("div",{className:"badge badge-pill badge-success"},o.a.createElement("a",{href:"mailto:"+t,title:t},e))}},{key:"onClickHide",value:function(){this.setState({isVisible:!1})}},{key:"renderEdit",value:function(){return o.a.createElement("span",null,o.a.createElement("a",{href:"https://"+this.host+"/app/task/"+this.task.token,target:"_blank",rel:"noopener noreferrer"},o.a.createElement("img",{src:"./assets/pencil.svg",alt:""})),"\xa0\xa0\xa0")}},{key:"renderEditEmpty",value:function(){return o.a.createElement("span",null)}},{key:"renderHide",value:function(){return o.a.createElement("span",null,o.a.createElement("img",{src:"./assets/hide.svg",alt:"",width:"14",height:"16",onClick:this.onClickHide.bind(this)}),"\xa0\xa0\xa0")}},{key:"renderHideEmpty",value:function(){return o.a.createElement("span",null)}},{key:"renderStatus",value:function(e){return 2===e?o.a.createElement("span",{className:"badge badge-warning"},"Termin\xe9"):void 0}},{key:"render",value:function(){var e=this;return!1===this.state.isVisible?"":o.a.createElement("div",{className:"card task-card"},o.a.createElement("div",{className:"card-header task-card",id:"heading_"+this.task.id},o.a.createElement(p.Consumer,null,function(t){return t.edit_icon?e.renderEdit():e.renderEditEmpty()}),o.a.createElement(p.Consumer,null,function(t){return t.show_hide?e.renderHide():e.renderHideEmpty()}),this.task.name,"\xa0\xa0",this.renderStatus(this.task.status),"\xa0\xa0","."===this.task.contact_email?this.renderContactEmpty(this.task.contact):this.renderContactFull(this.task.contact,this.task.contact_email)),o.a.createElement(p.Consumer,null,function(t){var n=t.task_details;return o.a.createElement("div",{id:"collapse_"+e.task.id,className:n?"collapse show":"collapse","aria-labelledby":"heading_"+e.task.id,"data-parent":"#accordionTask"},o.a.createElement("div",{className:"card-body"},o.a.createElement("span",{className:"task_note"},o.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.task.notes_html}}))))}))}}]),t}(o.a.Component)),b=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},n.host=e.host,n.token=e.token,n.tasks=e.tasks,n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"getPersons",value:function(e){return fetch("https://"+this.host+"/api/persons",{method:"GET",Host:this.host,headers:{Accept:"*/*",Authorization:"Bearer "+e,"cache-control":"no-cache","Content-Type":"application/json"}}).then(function(e){if(e.ok)return e.json();console.log("error")})}},{key:"componentDidMount",value:function(){var e=this;this.getPersons(this.token).then(function(t){e.setState({personsList:t})}).catch(function(e){console.log(e)})}},{key:"assignedPerson",value:function(e,t){return e.forEach(function(e){var n=t.find(function(t){return t.id===e.assigned_to_id});n&&n.firstname&&n.lastname?(e.contact=n.firstname+" "+n.lastname,e.contact_email=n.email):n?(e.contact=n.email,e.contact_email=n.email):(e.contact="Non Affect\xe9",e.contact_email=".")}),e}},{key:"render",value:function(){var e=this;if(this.state.personsList){var t=this.assignedPerson(this.tasks,this.state.personsList).sort(function(e,t){return e.sequence>t.sequence?1:e.sequence<t.sequence?-1:0});return o.a.createElement("div",null,t.map(function(t){return o.a.createElement(g,{key:t.id,task:t,token:e.token,host:e.host})}))}return o.a.createElement("div",null,"Loading tasks ....")}}]),t}(o.a.Component),E=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={isVisible:!0},n.host=e.host,n.token=e.token,n.section=e.section,n.onClickHide=n.onClickHide.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getTasksOpened(this.token,this.section.id).then(function(t){e.setState({tasksList:t})}).catch(function(e){console.log(e)}),this.getTasksCompleted(this.token,this.section.id).then(function(t){e.setState({tasksListCompleted:t})}).catch(function(e){console.log(e)})}},{key:"getTasksOpened",value:function(e,t){return fetch("https://"+this.host+"/api/sections/"+t+"/tasks?status=open",{method:"GET",Host:this.host,headers:{Accept:"*/*",Authorization:"Bearer "+e,"cache-control":"no-cache","Content-Type":"application/json"}}).then(function(e){if(e.ok)return e.json();console.log("error")})}},{key:"getTasksCompleted",value:function(e,t){return fetch("https://"+this.host+"/api/sections/"+t+"/tasks?status=completed",{method:"GET",Host:this.host,headers:{Accept:"*/*",Authorization:"Bearer "+e,"cache-control":"no-cache","Content-Type":"application/json"}}).then(function(e){if(e.ok)return e.json();console.log("error")})}},{key:"onClickHide",value:function(){this.setState({isVisible:!1})}},{key:"renderHide",value:function(){return o.a.createElement("span",null,"\xa0\xa0\xa0",o.a.createElement("img",{src:"./assets/hide.svg",alt:"",width:"20",height:"20",onClick:this.onClickHide.bind(this)}))}},{key:"renderHideEmpty",value:function(){return o.a.createElement("span",null)}},{key:"render",value:function(){var e=this;if(this.state.tasksList&&this.state.tasksListCompleted){if(!1===this.state.isVisible)return"";var t={fontSize:"150%",color:"#"+this.section.color},n=this.state.tasksList.concat(this.state.tasksListCompleted);return o.a.createElement("div",{className:"card section-entry"},o.a.createElement("div",{className:"card-header section-card-header",id:"heading_"+this.section.id},o.a.createElement("div",{style:t},this.section.name,"\xa0",o.a.createElement("span",{className:"badge badge-info"},n.length),o.a.createElement(p.Consumer,null,function(t){return t.show_hide?e.renderHide():e.renderHideEmpty()}))),o.a.createElement("div",{className:"card-body section-card-body"},o.a.createElement(b,{token:this.token,host:this.host,tasks:n})))}return o.a.createElement("div",{className:"loading"},"Loading sections ...")}}]),t}(o.a.Component),j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).host=e.host,n.token=e.token,n.sectionsList=e.sectionsList,n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.sectionsList.sort(function(e,t){return e.sequence>t.sequence?1:e.sequence<t.sequence?-1:0});return o.a.createElement("div",{id:"accordion",className:"sectionlist"},t.map(function(t){return o.a.createElement(E,{key:t.id,token:e.token,host:e.host,section:t})}))}}]),t}(o.a.Component),y=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},n.host=e.host,n.token=e.token,n.projectID=e.projectID,n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"getSections",value:function(e,t){return fetch("https://"+this.host+"/api/projects/"+t+"/sections?status=active",{method:"GET",Host:this.host,headers:{Accept:"*/*",Authorization:"Bearer "+e,"cache-control":"no-cache","Content-Type":"application/json"}}).then(function(e){if(e.ok)return e.json();console.log("error")})}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.getSections(this.token,this.projectID).then(function(t){e.setState({sectionsList:t})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return this.state.sectionsList?o.a.createElement("div",null,o.a.createElement(j,{host:this.host,token:this.token,sectionsList:this.state.sectionsList})):o.a.createElement("div",{className:"loading"},"Loading ...")}}]),t}(o.a.Component),C=n(31),O=n(13),S=n.n(O),w=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={mode:k.followup,isConfigured:!1,token:0,projectID:0,setTokenAndProject:function(e,t){localStorage.setItem("access-token",e),localStorage.setItem("project-id",t),n.setState({token:e,projectID:t,isConfigured:!0})}},n.asReport=n.asReport.bind(Object(d.a)(n)),n.asAgenda=n.asAgenda.bind(Object(d.a)(n)),n.asFollowUp=n.asFollowUp.bind(Object(d.a)(n)),n.asActionReport=n.asActionReport.bind(Object(d.a)(n)),n.handleClearSettings=n.handleClearSettings.bind(Object(d.a)(n)),n.handleForcePageReload=n.handleForcePageReload.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(r.a)(t,[{key:"getProjects",value:function(e){return fetch("https://"+this.host+"/api/projects?status=active",{method:"GET",Host:this.host,headers:{Accept:"*/*",Authorization:"Bearer "+e,"cache-control":"no-cache","Content-Type":"application/json"}}).then(function(e){if(e.ok)return e.json();console.log("error")})}},{key:"componentWillMount",value:function(){this.host="www.meistertask.com",this.handleLoadSettings()}},{key:"componentDidMount",value:function(){}},{key:"asReport",value:function(){this.context.mode=k.report,this.setState({mode:k.report})}},{key:"asAgenda",value:function(){this.context.mode=k.agenda,this.setState({mode:k.agenda})}},{key:"asFollowUp",value:function(){this.context.mode=k.followup,this.setState({mode:k.followup})}},{key:"asActionReport",value:function(){this.context.mode=k.actionreport,this.setState({mode:k.actionreport})}},{key:"handleLoadSettings",value:function(){var e=localStorage.getItem("access-token"),t=localStorage.getItem("project-id");null===t||null===e?this.setState({isConfigured:!1}):(this.setState({projectID:t}),this.setState({token:e}),this.setState({isConfigured:!0}))}},{key:"handleClearSettings",value:function(){localStorage.removeItem("access-token"),localStorage.removeItem("project-id"),this.setState({isConfigured:!1})}},{key:"handleForcePageReload",value:function(){document.location.reload(!0)}},{key:"render",value:function(){var e=this;return!1===this.state.isConfigured?o.a.createElement(p.Provider,{value:this.state},o.a.createElement(v,null)):o.a.createElement("div",null,o.a.createElement("div",{className:"menu"},o.a.createElement(S.a,{"aria-label":"Basic example"},o.a.createElement(C.a,{variant:"danger",onClick:function(){window.confirm("Voulez vous supprimer les param\xe8tres de configuration ?")&&e.handleClearSettings()}},"X"),o.a.createElement(C.a,{variant:"secondary",onClick:this.asReport},"Rapport"),o.a.createElement(C.a,{variant:"secondary",onClick:this.asAgenda},"Ordre du jour"),o.a.createElement(C.a,{variant:"secondary",onClick:this.asFollowUp},"Avancement"),o.a.createElement(C.a,{variant:"secondary",onClick:this.asActionReport},"Retours/Actions"),o.a.createElement(C.a,{variant:"success",onClick:this.handleForcePageReload},o.a.createElement("img",{src:"./assets/reload.svg",width:"20",height:"20"})))),o.a.createElement(p.Provider,{value:this.state.mode},o.a.createElement("div",{className:"jumbotron jumbotron-fluid title"},o.a.createElement(p.Consumer,null,function(e){var t=e.title;return o.a.createElement("div",{className:"container"},o.a.createElement("h1",null,t))})),o.a.createElement("div",{className:"container"},o.a.createElement(y,{host:this.host,token:this.state.token,projectID:this.state.projectID}))))}}]),t}(a.Component);w.contextType=p;var _=w;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(28);i.a.render(o.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.72ffb0dc.chunk.js.map